# é˜¶æ®µä¸€ï¼šæ•°æ®åº“å±‚å¼€å‘å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“æ¨¡å‹åˆ›å»º

å·²åˆ›å»ºä¸‰ä¸ªæ•°æ®åº“æ¨¡å‹æ–‡ä»¶ï¼Œå®Œå…¨å‚è€ƒ `blood_pressure.py` çš„å®ç°æ¨¡å¼ï¼š

- âœ… `infrastructure/database/models/health_event.py` - å¥åº·äº‹ä»¶è®°å½•æ¨¡å‹
  - è¡¨åï¼š`biz_agent_health_event_records`
  - å­—æ®µï¼šid, user_id, event_type, event_name, event_date, location, description, notes, created_at, updated_at

- âœ… `infrastructure/database/models/medication.py` - ç”¨è¯è®°å½•æ¨¡å‹
  - è¡¨åï¼š`biz_agent_medication_records`
  - å­—æ®µï¼šid, user_id, medication_name, dosage, frequency, start_date, end_date, doctor_name, purpose, notes, created_at, updated_at

- âœ… `infrastructure/database/models/symptom.py` - ç—‡çŠ¶è®°å½•æ¨¡å‹
  - è¡¨åï¼š`biz_agent_symptom_records`
  - å­—æ®µï¼šid, user_id, symptom_name, severity, start_time, end_time, duration, location, description, notes, created_at, updated_at

### 2. Repository åˆ›å»º

å·²åˆ›å»ºä¸‰ä¸ªRepositoryæ–‡ä»¶ï¼Œå®Œå…¨å‚è€ƒ `blood_pressure_repository.py` çš„å®ç°æ¨¡å¼ï¼š

- âœ… `infrastructure/database/repository/health_event_repository.py`
  - å®ç°æ–¹æ³•ï¼š`get_by_user_id()`, `get_by_date_range()`
  - ç»§æ‰¿ `BaseRepository`ï¼Œè‡ªåŠ¨è·å¾— CRUD æ–¹æ³•

- âœ… `infrastructure/database/repository/medication_repository.py`
  - å®ç°æ–¹æ³•ï¼š`get_by_user_id()`, `get_by_date_range()`
  - ç»§æ‰¿ `BaseRepository`ï¼Œè‡ªåŠ¨è·å¾— CRUD æ–¹æ³•

- âœ… `infrastructure/database/repository/symptom_repository.py`
  - å®ç°æ–¹æ³•ï¼š`get_by_user_id()`, `get_by_date_range()`
  - ç»§æ‰¿ `BaseRepository`ï¼Œè‡ªåŠ¨è·å¾— CRUD æ–¹æ³•

### 3. æ¨¡å‹å¯¼å…¥æ›´æ–°

- âœ… æ›´æ–° `infrastructure/database/models/__init__.py`
  - æ·»åŠ äº† `HealthEventRecord`, `MedicationRecord`, `SymptomRecord` çš„å¯¼å…¥

- âœ… æ›´æ–° `alembic/env.py`
  - æ·»åŠ äº†æ–°æ¨¡å‹çš„å¯¼å…¥ï¼Œç¡®ä¿ Alembic èƒ½å¤Ÿæ£€æµ‹åˆ°æ–°è¡¨

### 4. æ•°æ®åº“è¿ç§»è„šæœ¬

- âœ… åˆ›å»ºäº†è¿ç§»è„šæœ¬ï¼š`alembic/versions/b65f9b55f4e3_add_health_event_medication_symptom_.py`
  - åŒ…å«ä¸‰ä¸ªæ–°è¡¨çš„åˆ›å»ºæ“ä½œ
  - åŒ…å«æ‰€æœ‰å¿…è¦çš„ç´¢å¼•
  - åŒ…å«é™çº§ï¼ˆdowngradeï¼‰æ“ä½œ

## âš ï¸ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œçš„æ“ä½œ

### æ‰§è¡Œæ•°æ®åº“è¿ç§»

**é‡è¦**ï¼šéœ€è¦æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»å‘½ä»¤æ¥åˆ›å»ºæ•°æ®è¡¨ã€‚

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
alembic upgrade head
```

**æ³¨æ„äº‹é¡¹**ï¼š
1. æ‰§è¡Œå‰è¯·ç¡®ä¿æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®ï¼ˆ`.env` æ–‡ä»¶ï¼‰
2. å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œï¼ŒéªŒè¯æ— è¯¯åå†åœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œ
3. æ‰§è¡Œå‰å»ºè®®å¤‡ä»½æ•°æ®åº“

## ğŸ“‹ ä»£ç è´¨é‡æ£€æŸ¥

- âœ… æ‰€æœ‰ä»£ç é€šè¿‡ linter æ£€æŸ¥ï¼Œæ— é”™è¯¯
- âœ… ä»£ç é£æ ¼ä¸ç°æœ‰ä»£ç ä¿æŒä¸€è‡´
- âœ… æ‰€æœ‰æ¨¡å‹å’ŒRepositoryéƒ½åŒ…å«å®Œæ•´çš„ç±»å‹æç¤ºå’Œæ–‡æ¡£å­—ç¬¦ä¸²

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶

1. `infrastructure/database/models/health_event.py`
2. `infrastructure/database/models/medication.py`
3. `infrastructure/database/models/symptom.py`
4. `infrastructure/database/repository/health_event_repository.py`
5. `infrastructure/database/repository/medication_repository.py`
6. `infrastructure/database/repository/symptom_repository.py`
7. `alembic/versions/b65f9b55f4e3_add_health_event_medication_symptom_.py`

### ä¿®æ”¹æ–‡ä»¶

1. `infrastructure/database/models/__init__.py` - æ·»åŠ æ–°æ¨¡å‹å¯¼å…¥
2. `alembic/env.py` - æ·»åŠ æ–°æ¨¡å‹å¯¼å…¥

## ğŸ¯ ä¸‹ä¸€æ­¥å·¥ä½œ

é˜¶æ®µä¸€å·²å®Œæˆï¼Œå¯ä»¥å¼€å§‹é˜¶æ®µäºŒï¼šå·¥å…·å±‚å¼€å‘ã€‚

é˜¶æ®µäºŒéœ€è¦ï¼š
1. åˆ›å»ºå·¥å…·ç›®å½•ç»“æ„
2. å®ç° recordã€queryã€update ä¸‰ä¸ªå·¥å…·å‡½æ•°
3. åœ¨å·¥å…·æ³¨å†Œè¡¨ä¸­æ³¨å†Œæ–°å·¥å…·

## ğŸ“š å‚è€ƒæ–‡æ¡£

- å¼€å‘æ–¹æ¡ˆï¼š`doc/è®¾è®¡V3.0/V3.2 é‡æ„èŠå¤©é“¾è·¯/æ–°å¢Agentå¼€å‘æ–¹æ¡ˆä¸å®ç°è®¡åˆ’.md`
- Alembicæ“ä½œæ‰‹å†Œï¼š`doc/æŒ‡ä»¤ç±»æ–‡ç« /101-Alembicæ“ä½œæ‰‹å†Œ.md`
