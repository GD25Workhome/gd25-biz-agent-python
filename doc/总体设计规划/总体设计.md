# 系统组成
- IM服务
    - 聊天服务
    - 记录聊天信息
- Agent服务
    - 对接聊天模型
    - 对接embedding模型
    - 对接向量库，支持rag
    - 长期记忆管理
    - 管理Agent的工具
    - 对接langfuse
- his服务
    - 业务数据管理
        - 血压
        - 用药
        - 习惯
    - 用户信息管理
    - 原始资料管理

# 服务依赖关系
## 群聊场景下的依赖逻辑
1. 患者在群内发言
2. IM调用Agent聊天接口
3. Agent触发回复逻辑
    1. 查询患者历史聊天记录
    2. 查询患者档案信息
        1. 用户画像（长期记忆模块）
        2. 用户近期数据（血压、用药、习惯记录。与用户画像一起组成更精确的信息）
    3. 意图识别
    4. 专用Agent处理流程
        1. 

# Agent的总体设计
## 核心组成
1. langGraph动态流程
2. Agent的注册机制